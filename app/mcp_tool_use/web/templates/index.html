<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Marketplace DeepNLP Integration AI Search</title>
    <link rel="stylesheet" href="{{ url_for('static', path='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('plugin', path='agent_toolbox/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('plugin', path='mcp_marketplace_v1/styles.css') }}">

    <!-- markdown and safe xml -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.0/marked.min.js"></script>

</head>
<body>
    <div class="app-container">
        <div class="sidebar">
            <button class="collapse-btn">â‰¡</button>
            
            <div class="sidebar-item" id="new-chat">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>
                </svg>
                <span class="sidebar-text">New Chat</span>
            </div>
            <div class="sidebar-item" id="mcp-marketplace-sidebar">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                    <path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z" fill="currentColor"/>
                </svg>
                <span class="sidebar-text">MCP Marketplace</span>
            </div>            
            <div class="sidebar-section">
                <h3 class="sidebar-header">History</h3>
                <ul class="chat-history" id="chat-history">
                    <li class="history-item">Chat 1</li>
                    <li class="history-item">Chat 2</li>
                    <li class="history-item">Chat 3</li>
                    <li class="history-item">Chat 4</li>
                </ul>
            </div>
            
            <div class="user-center">
                <div class="user-avatar">U</div>
                <div class="user-info">
                    <span class="username">Username</span>
                    <button class="setting-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" fill="currentColor"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="chat-container" id="chatbox">
            </div>
            
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea id="searchInput" placeholder="Please ask anything..." rows="1"></textarea>
                    <button id="sendBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" fill="currentColor"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="button-container">
                    <div class="dropdown">
                        <button class="action-btn" id="modelBtn" data-value="claude-opus-4">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z" fill="currentColor"/>
                            </svg>
                            <span>Claude Opus 4</span>
                        </button>
                        <div class="dropdown-content">
                            <div class="dropdown-item" data-value="claude-opus-4">
                                <strong>Claude Opus 4</strong>
                                <span>Claude Opus 4</span>
                            </div>
                            <div class="dropdown-item" data-value="claude-3.7">
                                <strong>Claude 3.7</strong>
                                <span>Claude 3.7</span>
                            </div>                            
                            <div class="dropdown-item" data-value="gpt-4o">
                                <strong>GPT-4o</strong>
                                <span>GPT-4o</span>
                            </div>
                            <div class="dropdown-item" data-value="gemini-2.5-flash">
                                <strong>Gemini 2.5 Flash</strong>
                                <span>Gemini 2.5 Flash</span>
                            </div>                         
                            <div class="dropdown-item" data-value="qwen3-max">
                                <strong>Qwen3 Max</strong>
                                <span>Qwen3 Max</span>
                            </div>
                            <div class="dropdown-item" data-value="qwen3-plus">
                                <strong>Qwen3 plus</strong>
                                <span>Qwen3 plus</span>
                            </div>                            
                            <div class="dropdown-item" data-value="deepseek-r1">
                                <strong>DeepSeek R1</strong>
                                <span>DeepSeek R1</span>
                            </div>
                        </div>
                    </div>
<!-- 
                    <button class="action-btn" id="thinkBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-4h2v2h-2zm1-12c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z" fill="currentColor"/>
                        </svg>
                        <span>Think</span>
                    </button>

                    <button class="action-btn" id="webSearchBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H4v-4h11v4zm0-5H4V9h11v4zm5 5h-4V9h4v9z" fill="currentColor"/>
                        </svg>
                        <span>Web</span>
                    </button>

                    <button class="action-btn" id="imageUploadBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z" fill="currentColor"/>
                        </svg>
                        <span>Image</span>
                        <input type="file" id="imageFile" accept="image/*" hidden>
                    </button>

                    <button class="action-btn" id="fileUploadBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" fill="currentColor"/>
                        </svg>
                        <span>File</span>
                        <input type="file" id="documentFile" accept=".pdf,.doc,.docx,.txt" hidden>
                    </button>
                    
                    <button class="action-btn" id="templateBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 14H7v-2h4v2zm0-4H7v-2h4v2zm0-4H7V7h4v2zm6 8h-4v-2h4v2zm0-4h-4v-2h4v2zm0-4h-4V7h4v2z" fill="currentColor"/>
                        </svg>
                        <span>Agent</span>
                    </button>
                    
                    <button class="action-btn" id="memoryBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                            <path d="M17 3H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7V5h10v14z" fill="currentColor"/>
                        </svg>
                        <span>Memory</span>
                    </button> -->
                </div>
            </div>

            <!-- debug section -->
            <div id="system-messages" class="system-messages"></div>

        </div>
    </div>
    
    <div class="custom-panel" id="templatePanel">
        <div class="panel-header">
            <h3>Agent ToolBox</h3>
            <button class="close-panel">&times;</button>
        </div>
        <div class="panel-content">

            <div class="panel-section">
                <h4>Filter By Category</h4>
                <select id="templateSelect">
                    <option value="Map">Map</option>
                    <option value="Browser">Browser</option>
                    <option value="Finance">Finance</option>
                    <option value="Law">Law</option>
                    <option value="Coding">Coding</option>
                </select>

                <div id="template-tools-wrapper" class="panel_section">
                    <div id="template-tools" class="template-tools">
                        {% for key, value in mcp_marketplace_servers.items() %}
                            {% for item in value %}
                                <div class="tool-item">
                                    {% if item.thumbnail_picture %}
                                        <img class="display_card_image_thumbnail_img" src="{{ item.thumbnail_picture }}">
                                    {% else %}
                                        <div class="div_icon_default_name">MCP</div>
                                    {% endif %}
                                    <a hidden="true" class="tool_id">{{ item.id }}</a>
                                    <h3 class="content_name">{{ item.content_name }}</h3>
                                    <p class="description">{{ item.description }}</p>
                                    <p class="category">{{ item.subfield }}</p>
                                </div>
                            {% endfor %}
                        {% endfor %}
                    </div>
                </div>
            </div>

<!--             <div class="panel-section">
                <h4>Filter By Category</h4>
                <select id="templateSelect">
                    <option value="Map">Map</option>
                    <option value="Browser">Browser</option>
                    <option value="Finance">Finance</option>
                    <option value="Law">Law</option>
                    <option value="Coding">Coding</option>
                </select>
                
                <div id="template-tools-wrapper" class="panel_section">
                    <div id="template-tools" class="template-tools">
                        <div class="tool-item">
                            <a hidden="true" class="tool_id">ID 1</a>
                            <div class="div_icon_default_name">MCP</div>
                            <h3 class="content_name">MCP Server 1</h3>
                            <p class="description">MCP Server 1</p>
                            <p class="category">Category</p>
                        </div>
                        <div class="tool-item">
                            <a hidden="true" class="tool_id">ID 2</a>
                            <div class="div_icon_default_name">MCP</div>
                            <h3 class="content_name">MCP Server 2</h3>
                            <p class="description">MCP Server 2</p>
                            <p class="category">Category</p>
                        </div> 
                        <div class="tool-item">
                            <a hidden="true" class="tool_id">ID 3</a>
                            <div class="div_icon_default_name">MCP</div>
                            <h3 class="content_name">MCP Server 3</h3>
                            <p class="description">MCP Server 3</p>
                            <p class="category">Category</p>
                        </div> 
                        <div class="tool-item">
                            <a hidden="true" class="tool_id">ID 4</a>
                            <div class="div_icon_default_name">MCP</div>
                            <h3 class="content_name">MCP Server 4</h3>
                            <p class="description">MCP Server 4</p>
                            <p class="category">Category</p>
                        </div>          
                    </div>
                    <div id="template-page-selector" class="page_selector"></div>
                </div>
            </div> -->
            
            <!-- import plugin -->
<!--             <div class="panel-section">
                <h4>Category Template</h4>
                <select id="templateSelect">
                    <option value="browser">Browser</option>
                    <option value="finance">Finance</option>
                    <option value="law">Law</option>
                    <option value="coding">Coding</option>
                </select>
                
                <div id="template-tools" class="grid-container">
                    <div class="grid-item">å·¥å…· 1</div>
                    <div class="grid-item">å·¥å…· 2</div>
                    <div class="grid-item">å·¥å…· 3</div>
                    <div class="grid-item">æ›´å¤š...</div>
                </div>
            </div>
 -->
            <div class="panel-section">
                <h4>Search & Add Tool</h4>
                <div class="search-box">
                    <input id="search-box-input" type="text" placeholder="Search Tool...">
                    <button id="search-box-button" class="search-box-button">Search</button>
                </div>
                <div id="tools-search-results-wrapper" class="search-results">
                    <div id="tools-search-results" class="template-tools">
                        <div class="tool-item">
                            <a hidden="true" class="tool_id">Demo ID 1</a>
                            <div class="div_icon_default_name">Tool</div>
                            <h3 class="content_name">New Tool 1</h3>
                            <p class="description"></p>
                            <p class="category">New Tool 1</p>
                        </div> 
                        <div class="tool-item">
                            <a hidden="true" class="tool_id">Demo ID 2</a>
                            <div class="div_icon_default_name">Tool</div>
                            <h3 class="content_name">New Tool 2</h3>
                            <p class="description"></p>
                            <p class="category">New Tool 2</p>
                        </div> 
                    </div>
                </div>
            </div>
            <div class="panel-section">
                <h4>My Tools</h4>
                <div id="my-tools-wrapper" class="my-tools">
                    <div class="tool-item">
                        <a hidden="true" class="tool_id">Browser Tool 1</a>
                        <div class="div_icon_default_name">Tool</div>
                        <h3 class="content_name">Browser Tool 1</h3>
                        <p class="description"></p>
                        <p class="category">Browser</p>
                    </div> 
                    <div class="tool-item">
                        <a hidden="true" class="tool_id">Map Tool 1</a>
                        <div class="div_icon_default_name">Tool</div>
                        <h3 class="content_name">Map Tool 1</h3>
                        <p class="description"></p>
                        <p class="category">Map</p>
                    </div> 
                </div>
            </div>

            <div class="panel-section">
                <div class="search-box">
                    <button id="tool-export-button" class="search-box-button">Update</button>
                </div>
            </div>
        </div>

        <div id="modal-trigger"></div>
        <div class="modal-overlay"></div>
        <div class="json-modal">
            <button class="close-modal-btn">&times;</button>
            <div class="json-display" id="json-content">
                {
                  "mcpServers": {}
                }
            </div>
            <div class="modal-footer">
                <button class="copy-btn">Copy</button>
            </div>
        </div>
    </div>
<!--     <script type="text/javascript" src="./plugin/mcp_marketplace_v1/scripts.js"></script>
 -->

    <div class="custom-panel" id="memoryPanel">
        <div class="panel-header">
            <h3>Memory Setting</h3>
            <button class="close-panel">&times;</button>
        </div>
        <div class="panel-content">
            <div class="memory-option">
                <input type="checkbox" id="memoryToggle" checked>
                <label for="memoryToggle">Memory Enable</label>
            </div>
            
            <div class="memory-sources">
                <h4>Knowledge Base</h4>
                <div>
                    <input type="checkbox" id="githubSource" checked>
                    <label for="githubSource">GitHub</label>
                </div>
                <div>
                    <input type="checkbox" id="blogSource" checked>
                    <label for="blogSource">Blog</label>
                </div>
                <div>
                    <input type="checkbox" id="twitterSource">
                    <label for="twitterSource">Twitter/X</label>
                </div>
                <div>
                    <input type="checkbox" id="facebookSource">
                    <label for="facebookSource">Facebook</label>
                </div>
            </div>
            
            <div class="memory-actions">
                <button class="save-btn">Save Settings</button>
                <button class="clear-btn">Clean Memory</button>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="{{ url_for('static', path='scripts/scripts.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('plugin', path='agent_toolbox/scripts.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('plugin', path='mcp_marketplace_v1/scripts.js') }}"></script>

</body>
</html>
